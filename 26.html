<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="source/favicon.ico" type="image/x-icon">
    <title>Уроки | University 2.0</title>
    <link rel="stylesheet" href="source/main.css">
    <link rel="stylesheet" href="source/style.css">

    <link rel="stylesheet" href="source/tikets.css">
    <link rel="stylesheet" href="source/profile_window.css">

    <link rel='stylesheet' href="source/default.css">
    <link rel='stylesheet' href="source/idea.css">
    <script type="text/javascript" src="source/highlight.pack.js"></script>
</head>
<body>


    <div id="myfond_gris" opendiv=""></div>
    <div align="center" style="padding-top:35px;">
        <div id="box_1" class="mymagicoverbox_fenetre" style="left:-225px; width:450px;">
            Anon | 00500
            <div class="mymagicoverbox_fenetreinterieur" style="height:220px; ">
                <div align="left">
                    <p class="lead">Имя пользователя: Anon</p>
                    <p class="lead">Статус: Активен</p>
                    <p class="lead">Регистрация jabber: <a target="_blank" href="http://plast.cash/registration.php?key="></a></p>
                    <p class="lead">Поток: Anon</p>
                    <p class="lead">TG канал: <a target="_blank" href="">Канал для опретивных оповещений</a></p>
                    
                    <br><br>
                    <div style="width:100px" align="center" class="mymagicoverbox_fermer">Закрыть</div>
                </div>
            </div>
        </div>
    </div>



<div class="main_container">
    <header>
        <a href="index.html"><img class="logo" src="source/logo.png" alt="University 2.0"></a>
        <div class="header_right">
            <div class="user_info">
                <p>Hello,
                <a href="#" iddiv="box_1" class="mymagicoverbox"> Anon </a>


                </p>
                <p>ID: 00500</p>
            </div>
            <div class="user_actions">
                <a href="help.html"
                   class="btn btn_gray btn_transparent btn_border_transparent btn_icon btn_icon_help">Помощь</a>
                
                    
                    <a href="index.html" class="btn  btn_round btn_status btn_status_active btn_gray btn_exit">Выход</a>
                
            </div>
        </div>
    </header>
    <div class="container">
        <nav>
            <a href="index.html" class="btn btn_icon btn_icon_dashboard ">Сводка</a>
            <a href="lections.html" class="btn btn_icon btn_icon_book active">Лекции</a>
            <a href="index.html" class="btn btn_icon btn_icon_group ">Тикеты</a>
            <a href="faq.html" class="btn btn_icon btn_icon_chat ">FAQ</a>
        </nav>
        <div class="content">

<a href="hack.html">       
    <div class="banner_block" style="background-image:url('source/hack_9X2ouwy.jpg')">
        <div class="banner_content">
            <h2>Хак</h2>
            <p>Лучшая защита - это нападение.</p>
        </div>
    </div>
    </a>
    <br>

            

            
    <div class="article_actions">
        <a href="hack.html" class="btn btn_round btn_gray  btn_icon btn_icon_back ">Назад</a>
    </div>

 <div class="text_content">
        <p>Для доступа по shh нужно знать к кому подключаться (ip или host name), порт (по умолчанию 22), имя пользователя и пароль. Также нужен клиент, вообще все протоколы из стека TCP/IP это клиент-серверные протоколы, т.е. есть сервер, ожидающий подключения от клиента, и есть клиент, инициирующий подключение к серверу. Почти во всех дистрибутивах линукс клиент ssh идет в комплекте и доступен по команде &laquo;ssh&raquo;</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh host -p 22 -l user</div>

<p>где -p это номер порта, -l &mdash; имя пользователя. Можно подключаться и так:</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host -p22</div>

<p>а если порт 22 то</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host</div>

<p>Все три команды идентичны и приведут к одному и тому же результату.</p>

<p>После успешного подключения тебе предоставляется доступ к shell`у удаленной машины. С этого момента все команды будут отправлены на сервер, выполнены и их результат будет отправлен обратно. Выглядит это так же как и при работе с эмулятором терминала на своей машине.</p>

<p>Конфигурационный файл сервера sshd находится по пути &quot;/etc/ssh/sshd_config&quot;, доступ к которому имеет только администратор. А каждый пользователь, имеющий доступ по ssh, в домашнем каталоге хранит папку .ssh, в которой располагаются ключи аутентификации, файл с хешем открытых ключей клиентов и хеши открытых ключей серверов.</p>

<p>SSH поддерживает разные алгоритмы аутентификации мы разберем 2 основных - это авторизации по паролю и по ключу. С паролем все ясно, а вот с ключами интресенее. Для начала нам нужна своя пара ключей.</p>

<blockquote>
<p>Очень часто администраторы забывают о том, что ssh поддерживает безпарольную аутентификацию по ключам. Если раз добавить на сервер свой ключ, то доступ сохранится даже после смены пароля.</p>
</blockquote>

<p>Наверное тут надо сказать, что алгортмы шифрования делятся на 2 типа: симметричные и ассиметричные; симметричные алгоритмы шифрования (AES, Blowfish, DES) используют один ключ для шифрования и дешифрования информации (типо пароль), ассиметричные алгоритмы шифрования (RSA) использют пару ключей: открытый для шифрования и закрытый для дешифрования. Например Оля и Вася решили обмениваться зашифрованными с помощью RSA сообщениями. Для этого Вася генерирует себе пару ключей (открытый и закрытый) и Оля делает тоже самое. Чтобы начать общение Вася должен передать Оле свой открытый ключ и Оля должна передать вас свой открытый ключ. Теперь Вася шифрует свое сообщение открытым ключем Оли, а Оля может прочитать это сообщение дешифровав своим закрытым ключем. По открытому ключу невозможно расшифровать сообщение или восстановить закрытый ключ, в свою очередь зная закрытый ключ можно восстановить открытый. Т.е. для обеспечения защиты передаваемой информации оба должы обменяться открытыми ключами и обеспечить сохранность своих закрытых ключей.</p>

<p>Для того чтобы создать пару ключей для аутентификации по ssh нужно ввести команду</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh-keygen</div>

<p>Менеджер спросит куда сохранить ключи и парольную фразу. Если ввести пароль то для работы с ключами надо будет его вводить. Если не менять путь сохранения ключей, то лежать они будут по пути &quot;~/.ssh/&quot;, там &quot;id_rsa&quot; - приватный ключ, &quot;id_rsa.pub&quot; - публичный ключ. Теперь нужно передать этот ключ на ssh сервер. Можно воспользоваться командой</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh-copy-id user@host</div>

<p>Синтаксис тут такой же как и у &quot;ssh&quot;. Будет запрошен пароль сервера. После этого можно коннектиться к серверу как обычно, так как файлы ключей лежат по пути по умолчанию то</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host</div>

<p>если же нет то во-первых: приватный ключ должен иметь права 600, во-вторых: публичный - 644; и нужно добавить ключ &quot;-i&quot;</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host -i /path/to/id_rsa</div>

<p>При этом при подключении публичный ключ уже не нужен, хотя я настоятельно рекомендую хранить оба ключа в одной папке и настроить на нее правильный права.</p>

<p>Существует и другой способ прогрузки публичного ссш ключа.</p>

<blockquote>
<p>К слову сказать, что один чел оказывал услугу по прогрузке ссш ключей на сервера с веб шелом. Только представь, ему платили за то что я сейчас рассказываю. Платили потому, что он прикрыл лавочку по неизвестным причинам.</p>
</blockquote>

<p>Как я уже сказал у пользователя есть директория .ssh, кстати ее можно и создать, так вот в этой директории есть файл &quot;authorized_keys&quot; в котором и хранятся публичные ключи прогружаемые через &quot;ssh-copy-id&quot; и ничего не мешает тебе в ручную просто вставить свой публичный ключ в новую строку в этот файл. Результат будет одинаковый.</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ echo &quot;your pub key&quot; &gt;&gt; /home/user/.ssh/authorized_keys</div>

<p>Все, теперь даже если кто то сменит пароль пользователю, то мы все равно сохраним доступ, пока наш ключ не будет удален из файла authorized_keys.</p>

<p>Через ssh можно не только выполнять команды, а еще и серфить интернет, для этого трафик между локальной машиной и сервером туннелируется и во вне трафик идет уже с сервера. Для проброса одного порта (создания прокси) используется такая команда</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh -T RPM@72.192.91.13 -D 8080</div>

<p>Параметр -T отключит псевдо терминал, а -D прибиндит порт. Таким образом на локал хосте у тебя будет висеть прокси на порту 8080. Пару скринов для POC</p>

<p><a href="source/ff_whoer_1.png"><img alt="" src="source/ff_whoer_1.png" style="height:300px; width:100%" /></a></p>

<p>Вот такой ип у меня сейчас. Теперь включаю ссш туннель и биндю его на порт 44444</p>

<p><a href="source/run_ssh_proxy.png"><img alt="" src="source/run_ssh_proxy.png" style="height:250px; width:100%" /></a></p>

<p>тут я еще указал путь до ключа. Теперь надо прописать прокси в браузер. Для менеджеринга прокси я юзаю FoxyProxy</p>

<p><a href="source/ff_proxy_add.png"><img alt="" src="source/ff_proxy_add.png" style="height:400px; width:100%" /></a></p>

<p>Теперь мой внешний ип равен ип ссш сервера</p>

<p><a href="source/ff_whoer_2.png"><img alt="" src="source/ff_whoer_2.png" style="height:400px; width:100%" /></a></p>

<p>Также поменялся провайдер и имя хоста и днс тоже, последнее потому что я указал что это SOCKS5 прокси, которые в свою очередь поддерживают форвардинг днс.</p>

<p>Еще один пример создания туннеля с порта на порт. К примеру на удаленном сервере запущен какой то сервис, например IP телефонии, который работает на порту 5901. И тебе нужно соединиться с сервером так чтобы трафик между клиентом и сервером был зашифрован, то ты будешь пробрасывать туннель на конкретный порт.</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host -L 5901:127.0.0.1:5901 -N</div>

<p>Теперь указываешь в клиенте SIP адрес хоста как 127.0.0.1 и он заработает. Магия! Такая практика используется для проброса порта сервера базы данных, когда настраивают горизонтальное масшабирование для балансировки нагрузки или когда 2 сервера юзают один сервер с БД или просто когда сервер с БД хостится отдельно, в общем в любой ситуации когда необходимо получить доступ к серверу БД удаленно. Это лучше чем светить порт сервера БД в интернет, по ряду причин, одна из очевидных - это безопасность.</p>

<p>Если и этого недостаточно и хочется большего, то встречайте sshuttle. Утилита легко и просто настроит тебе глобальное туннелирование всего системного трафика. Делается это так:</p>

<p><a href="source/sshuttle.png"><img alt="" src="source/sshuttle.png" style="height:268px; width:100%" /></a></p>

<p>параметр --dns включит еще и форвардинг днс запросов, -e позволяет указать свою команду запуска ssh, в данном случае я указал путь до ключа. Выключаю прокси в браузере и результат, как говорится, на лицо ;-)</p>

<p><a href="source/ff_whoer_3.png"><img alt="" src="source/ff_whoer_3.png" style="height:400px; width:100%" /></a></p>

<p>И как я уже сказал, трафик туннелируется весь</p>

<p><a href="source/curl.png"><img alt="" src="source/curl.png" style="height:197px; width:100%" /></a></p>

<p style="text-align:center"><span style="color:#999999">ifconfig.me упорно отказывается отвечать если юзер агент не указывать</span></p>

<p>Заметил, что при использовании sshuttle на вхуере не светится, что я использую прокси? Чем же туннелирование лучше ТОРа в котором тоже невозожно перехватить и дешифровать трафик между тобой и выходной нодой? SSH туннели не поднимают куча правительственных организаций, чтобы мониторить пользователей ssh - это раз, быстрее чем ТОР - это два. И все это исключительно мое мнение!</p>

<p>Если ты полюбишь ссш, то придется полюбить и брутить ссш любишь кататься люби и с санками ебаться. А для начала вспомним, как можно узнать кто работает на машине? Правильно w/who. А что же делать, спросишь ты? Все достаточно просто. SSH позволяет последним параметром указать команду, которая будет выполнена на удаленном сервере (такой тип параметров называется позиционным). Если сделать вот так:</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host &quot;uname -a&quot;</div>

<p>то ты увидишь информацию о системе на удаленном сервере и будешь отключен от него. Ну а чтобы не палить свою сессию можно подключиться к серверу вот так:</p>

<div style="background:#eeeeee; border:1px solid #cccccc; padding:5px 10px">$ ssh user@host &quot;/bin/sh -i&quot;</div>

<p>и получить сессию sh в интерактивном режиме.</p>

<p><a href="source/ssh_sh_i_2.gif"><img alt="" src="source/ssh_sh_i_2.gif" style="height:400px; width:100%" /></a></p>

<p>На гифке видно, что я подключился к серверу дважды, а в списке w видно только одну сессию, это как раз потому что вторую сессию я запускал с указанием &quot;/bin/sh -i&quot; последним параметром. Таким нехитрым способом можно скрыть свое присутствие. Хотя тебя все равно можно обнаружить, просто для этого придется затратить больше усилий. Кстати пробрасывать туннель тоже лучше с указанием &quot;/bin/sh -i&quot;.</p>

<p>Теперь о бруте ssh. Брутить можно любым удобным способом, например гидрой. Тут ничего сложного нет, составить список для брута, взять пачку диапазонов и запустить софт. Можно уведичить конверсию запуская брут с захваченных серверов. Тут возникает несколько трудностей: отсутствие прав на установку гидры на сервер - это раз, наличие самой гидры уже палево - это два, если сервер потерять, то теряются все набрученные хосты - это три, ну и так далее.</p>
    </div>
    <br>

 
        </div>
    </div>
</div>
<footer>
    <p>University 2.0</p>
</footer>

</body>
</html>